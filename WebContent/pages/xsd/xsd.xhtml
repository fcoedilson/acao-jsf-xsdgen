<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:a4j="http://richfaces.org/a4j"
     xmlns:c="http://java.sun.com/jstl/core"
     xmlns:t="http://myfaces.apache.org/tomahawk">

	<div id="cadastro">
			
			<h2>Plataforma Ação - Gerador de XSD</h2>
			
			<fieldset style="margin-bottom:20px">

			    <legend>Arquivo</legend>	
				<dd>
					<h:outputLabel value="Nome" for="id" styleClass="labelNegrito"/>
					<h:inputText id="nomexsd" value="#{xmlBean.nomeArquivo}" required="true"  size="60" maxlength="255" style="text-transform:none;">
					</h:inputText>
					<rich:message errorClass="error" for="nomexsd" styleClass="message"/>
				</dd>

	    	</fieldset>
			
			<fieldset style="margin-bottom:20px">

			    <legend>Header do XSD</legend>	
				<dd>
					<h:outputLabel value="Target Namespace" for="id" styleClass="labelNegrito"/>
					<h:inputText id="tns" value="#{xmlBean.targetNamespace}" required="true"  size="60" maxlength="255" style="text-transform:none;">
					</h:inputText>
					<rich:message errorClass="error" for="tns" styleClass="message"/>
				</dd>

	    	</fieldset>
			
			<fieldset style="margin-bottom:20px">

			    <legend>Documento</legend>	
			    
					<dt><h:outputLabel value="Name" for="id" styleClass="labelNegrito"/></dt>
					<dd>
						<h:inputText id="id" value="#{xmlBean.formName}" required="true"  size="40" maxlength="255" style="text-transform:none;">
						</h:inputText>
						<rich:message errorClass="error" for="id" styleClass="message"/>
					</dd>

			  		<dt><h:outputLabel value="Label" for="titulo" 	styleClass="labelNegrito"/></dt>	
			  		<dd>	  	
						<h:inputText id="titulo" value="#{xmlBean.titulo}" required="true"  size="50" maxlength="100" style="text-transform:none;">
						</h:inputText>
						<rich:message errorClass="error" for="titulo" styleClass="message"/>
					</dd>

					<dt><h:outputLabel value="Classificação" for="classificacao" 	styleClass="labelNegrito"/></dt>
					<dd>
						<h:inputText id="classificacao" value="#{xmlBean.classificacao}" required="true"  size="50" maxlength="100" style="text-transform:none;">
						</h:inputText>
						<rich:message errorClass="error" for="classificacao" styleClass="message"/>
					</dd>

	    	</fieldset>

			<fieldset style="margin-bottom:20px">

			 	<legend>Inclusão de campos</legend>

				
				<fieldset style="margin-bottom:20px">
				
					 <legend>Campo</legend>

					<dt><h:outputLabel value="Name" for="idcampo" styleClass="labelNegrito"/></dt>
					<dd>
						<h:inputText id="idcampo" value="#{xmlBean.campo.name}"  size="30" maxlength="255" style="text-transform:none;">
						</h:inputText>
						<rich:message errorClass="error" for="idcampo" styleClass="message"/>
					</dd>
					
					<dt><h:outputLabel value="Label" for="nomeCampo" styleClass="labelNegrito"/></dt>
					<dd>
						<h:inputText id="nomeCampo" value="#{xmlBean.campo.label}"  size="40" maxlength="255" style="text-transform:none;">
						</h:inputText>
						<rich:message errorClass="error" for="nomeCampo" styleClass="message"/>
					</dd>
					
					<dt><h:outputLabel value="Mascara" for="maskara" styleClass="labelNegrito"/></dt>
					<dd>
						<h:selectOneMenu id="maskara" value="#{xmlBean.campo.maskara}" style="width:100px">
							<f:selectItem itemLabel="Nenhuma" itemValue=""/>
							<f:selectItem itemLabel="Númerico" itemValue="[0-9]+"/>
							<f:selectItem itemLabel="CPF" itemValue="[0-9]{3}\."/>
							<f:selectItem itemLabel="Númerico" itemValue="[0-9]+"/>
			    		</h:selectOneMenu>
			    		<rich:message errorClass="error" for="tipoCampo" styleClass="message"/>
					</dd>
					
					<dt><h:outputLabel value="Tipo" for="tipoCampo" styleClass="labelNegrito"/></dt>
					<dd>
						<h:selectOneMenu id="tipoCampo" value="#{xmlBean.campo.tipo}" required="true" style="width:100px">
							<f:selectItem itemLabel="Texto" itemValue="text"/>
							<f:selectItem itemLabel="Inteiro" itemValue="integer"/>
							<f:selectItem itemLabel="Float" itemValue="float"/>
							<f:selectItem itemLabel="Data" itemValue="data"/>
							<f:selectItem itemLabel="Select" itemValue="select"/>
							<f:selectItem itemLabel="Boolean" itemValue="boolean"/>
			    		</h:selectOneMenu>
			    		<rich:message errorClass="error" for="tipoCampo" styleClass="message"/>
					</dd>

					<dt><h:outputLabel value="Obrigatório" for="obrigatorio" styleClass="labelNegrito"/></dt>
					<dd>
						<h:selectOneMenu id="obrigatorio" value="#{xmlBean.campo.obrigatorio}" style="width:60px">
							<f:selectItem itemLabel="Sim" itemValue="1"/>
							<f:selectItem itemLabel="Não" itemValue="0"/>
				    		</h:selectOneMenu>
			    		<rich:message errorClass="error" for="obrigatorio" styleClass="message"/>
					</dd>

					<dt><h:outputLabel value="SubNível" for="subnivel" styleClass="labelNegrito"/></dt>
					<dd>

						<h:inputText id="subnivel" value="#{xmlBean.campo.labelSubnivel}"  size="40" maxlength="255" style="text-transform:none;"/>

						<h:selectOneMenu id="subnivelList" value="#{xmlBean.campo.labelSubnivel}" rendered="#{xmlBean.subNiveisStatus and false}" style="width:180px" converter="campoConverter">
							<f:selectItem itemLabel="Selecione ..." itemValue=""/>
		    				<t:selectItems value="#{xmlBean.subNivelList}" var="g" itemValue="#{g}" itemLabel="#{g}"/>
		    				<a4j:support event="onchange" action="#{xmlBean.populate}"/>
			    		</h:selectOneMenu>
						<rich:message errorClass="error" for="subnivelList" styleClass="message" rendered="false"/>
					</dd>

					<h:commandLink action="#{xmlBean.adicionarCampo}" value="Adicionar" reRender="panelSubNivel" styleClass="novo" style="padding-left:20px">
			      		<a4j:support event="onclick" reRender="dataTable2, subnivelList" />
			      	</h:commandLink>
			    
		      	</fieldset>
		      	
		      	<fieldset>
		      		
					<legend>Campos incluídos</legend>		      	
		      		<rich:dataTable id="dataTable2" value="#{xmlBean.campos}" var="campo" rows="10" rowKeyVar="index"
		      		   rowClasses="even, odd" 
			      		onRowMouseOver="jQuery(this).addClass('trHover')" 
			      		onRowMouseOut="jQuery(this).removeClass('trHover')" width="100%">
		
		 		      	<c:if test="#{empty xmlBean.campos}">
							<rich:column>
								<f:facet name="header">Nenhum campo cadastrado.</f:facet>
							</rich:column>
						</c:if>
		
			      		<c:if test="#{not empty xmlBean.campos}" >
		
							<rich:column width="2%" style="text-align: center;" > 
								<f:facet name="header"><h:outputText value="Nº" /></f:facet>
								<h:outputText value="#{index+1}" style="color: black;"/>
							</rich:column>
		
							<rich:column width="20%" style="text-align: left;" > 
								<f:facet name="header"><h:outputText value="Name" /></f:facet>
								<h:outputText value="#{campo.name}" style="color: black;"/>
							</rich:column>
	
							<rich:column width="20%" style="text-align: left;" > 
								<f:facet name="header"><h:outputText value="Label" /></f:facet>
								<h:outputText value="#{campo.label}" style="color: black;"/>
							</rich:column>
							
							<rich:column width="20%" style="text-align: left;" > 
								<f:facet name="header"><h:outputText value="Tipo" /></f:facet>
								<h:outputText value="#{campo.tipo}" style="color: black;"/>
							</rich:column>

							<rich:column width="20%" style="text-align: left;" > 
								<f:facet name="header"><h:outputText value="Maskara" /></f:facet>
								<h:outputText value="#{campo.maskara}" style="color: black;"/>
							</rich:column>
							
							<rich:column width="40%" style="text-align: left;" > 
								<f:facet name="header"><h:outputText value="Subnivel" /></f:facet>
								<h:outputText value="#{campo.labelSubnivel}" style="color: black;"/>
							</rich:column>
		
							<rich:column width="2%" style="text-align: center;">
								<f:facet name="header"><h:outputText value="Excluir" /></f:facet>
								<h:commandLink id="remove" styleClass="excluir"  action="#{xmlBean.removeCampo}" value="Excluir">
									<f:setPropertyActionListener target="#{xmlBean.campo}" value="#{campo}"/>
									<a4j:support event="oncomplete" reRender="paginaPrincipal"/>
								</h:commandLink>
							</rich:column>

						</c:if>
		      		</rich:dataTable>
		      	
		      	
		      	</fieldset>

	    	</fieldset>
	    	
			<fieldset>
			
				<legend>Indices</legend>
				<h:outputLabel value="Key" for="key" styleClass="labelNegrito"/>
				<h:inputText id="key" value="#{xmlBean.indice.key}"  size="30" maxlength="100" style="text-transform:none;"/>
				
				<h:outputLabel value="Path" for="path" styleClass="labelNegrito"/>
				<h:inputText id="path" value="#{xmlBean.indice.path}"  size="30" maxlength="100" style="text-transform:none;"/>
				
				<h:commandLink action="#{xmlBean.adicionarIndice}" value="Adicionar" styleClass="novo" style="padding-left:20px">
		      		<a4j:support event="onclick" reRender="dataTable1"/>
		      	</h:commandLink>
				
				<rich:dataTable id="dataTable1" value="#{xmlBean.indices}" var="indice" rows="10" rowKeyVar="index"
	      		   rowClasses="even, odd" 
		      		onRowMouseOver="jQuery(this).addClass('trHover')" 
		      		onRowMouseOut="jQuery(this).removeClass('trHover')" width="100%">
	
	 		      	<c:if test="#{empty xmlBean.indices}">
						<rich:column>
							<f:facet name="header">Nenhum indice cadastrado.</f:facet>
						</rich:column>
					</c:if>
	
		      		<c:if test="#{not empty xmlBean.indices}" >
	
						<rich:column width="2%" style="text-align: center;" > 
							<f:facet name="header"><h:outputText value="Nº" /></f:facet>
							<h:outputText value="#{index+1}" style="color: black;"/>
						</rich:column>
	
						<rich:column width="60%" style="text-align: left;" > 
							<f:facet name="header"><h:outputText value="Key" /></f:facet>
							<h:outputText value="#{indice.key}" style="color: black;"/>
						</rich:column>
						
						<rich:column width="60%" style="text-align: left;" > 
							<f:facet name="header"><h:outputText value="Path" /></f:facet>
							<h:outputText value="#{indice.path}" style="color: black;"/>
						</rich:column>
	
						<rich:column width="2%" style="text-align: center;">
							<f:facet name="header"><h:outputText value="Excluir" /></f:facet>
							<h:commandLink id="remove" styleClass="excluir"  action="#{xmlBean.removeIndice}" value="Excluir">
								<f:setPropertyActionListener target="#{xmlBean.indice}" value="#{indice}"/>
								<a4j:support event="oncomplete" reRender="dataTable1"/>
							</h:commandLink>
						</rich:column>

					</c:if>
	      		</rich:dataTable>
			</fieldset>



		<h:commandButton value="Gravar XSD" action="#{xmlBean.downloadXsdFile}" styleClass="button">
			<a4j:support event="oncomplete"  reRender="paginaPrincipal"/>
		</h:commandButton>
	

	</div>
	
</ui:composition>
