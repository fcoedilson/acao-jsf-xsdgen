<?xml version='1.0' encoding='UTF-8'?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:jsp="http://java.sun.com/JSP/Page"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:t="http://myfaces.apache.org/tomahawk">
	

		<fieldset style="margin-bottom:20px">
		
			 <legend>Campo</legend>

			<dt><h:outputLabel value="Name" for="idcampo" styleClass="labelNegrito"/></dt>
			<dd>
				<h:inputText id="idcampo" value="#{xmlBean.campo.name}"  size="30" maxlength="255" style="text-transform:none;">
				</h:inputText>
				<rich:message errorClass="error" for="idcampo" styleClass="message"/>
			</dd>
			
			<dt><h:outputLabel value="Label" for="nomeCampo" styleClass="labelNegrito"/></dt>
			<dd>
				<h:inputText id="nomeCampo" value="#{xmlBean.campo.label}"  size="40" maxlength="255" style="text-transform:none;">
				</h:inputText>
				<rich:message errorClass="error" for="nomeCampo" styleClass="message"/>
			</dd>
			
			<dt><h:outputLabel value="Mascara" for="maskara" styleClass="labelNegrito"/></dt>
			<dd>
				<h:selectOneMenu id="maskara" value="#{xmlBean.campo.maskara}" style="width:100px">
					<f:selectItem itemLabel="Selecione ..." itemValue=""/>
					<f:selectItem itemLabel="Data" itemValue="\d{2}/\d{2}/\d{4}"/>
					<f:selectItem itemLabel="RG" itemValue="[0-9]{20}"/>
					<f:selectItem itemLabel="CPF" itemValue="[0-9]{3}\."/>
					<f:selectItem itemLabel="Númerico" itemValue="[0-9]+"/>
					<f:selectItem itemLabel="Telefone" itemValue="(\(\d{2}\)-)?\d{4}-d{4}"/>
	    		</h:selectOneMenu>
	    		<rich:message errorClass="error" for="tipoCampo" styleClass="message"/>
			</dd>
			
			<dt><h:outputLabel value="Tipo" for="tipoCampo" styleClass="labelNegrito"/></dt>
			<dd>
				<h:selectOneMenu id="tipoCampo" value="#{xmlBean.campo.tipo}" style="width:100px">
					<f:selectItem itemLabel="Selecione ..." itemValue=""/>
					<f:selectItem itemLabel="Área de Texto" itemValue="textarea"/>
					<f:selectItem itemLabel="Autocomplete" itemValue="autocomplete"/>
					<f:selectItem itemLabel="Checkbox" itemValue="checkbox"/>
					<f:selectItem itemLabel="Data" itemValue="date"/>
					<f:selectItem itemLabel="Inteiro" itemValue="integer"/>
					<f:selectItem itemLabel="Float" itemValue="float"/>
					<f:selectItem itemLabel="Select" itemValue="select"/>
					<f:selectItem itemLabel="Texto" itemValue="text"/>
					<a4j:support event="oncomplete" action="#{xmlBean.verificarTipoCampo}" reRender="itemCampoLabel,itemCampo,itemCampoErro"/>
	    		</h:selectOneMenu>
	    		
	    		<h:commandLink action="#{xmlBean.verificarTipoCampo}" value="Item" styleClass="novo" style="padding-left:20px">
		      		<a4j:support event="onclick" action="#{xmlBean.verificarTipoCampo}" reRender="gridItemCampo"/>
		      	</h:commandLink>
		      	
	    		<h:commandLink action="#{xmlBean.verificarTipoCampo}" value="Auto Complete" styleClass="novo" style="padding-left:20px">
		      		<a4j:support event="onclick" action="#{xmlBean.verificarTipoCampo}" reRender="gridAutocompleteCampo"/>
		      	</h:commandLink>

			</dd>

			<a4j:outputPanel id="gridItemCampo" rendered="#{xmlBean.select}">
				<dt>
			    	<h:outputLabel id="itemCampoLabel" value="Item do campo" for="itemCampo" styleClass="labelNegrito"/>
			    </dt>
			    <dd>
		       		<h:inputText id="itemCampo" value="#{xmlBean.itemToInclude}"  size="28" maxlength="255" style="text-transform:none;"/>
		       		<h:commandLink action="#{xmlBean.adicionarItemCampo}" value="Salvar Item" styleClass="novo">
			      		<a4j:support event="onclick" reRender="dataTableItensCampo, gridItemCampo"/>
			      	</h:commandLink>
		      	</dd>
	       		<rich:message id="itemCampoErro" errorClass="error" for="itemCampo" styleClass="message"/>
	       	</a4j:outputPanel>


			<a4j:outputPanel id="gridAutocompleteCampo" rendered="#{xmlBean.autocomplete}" >
				<dt><h:outputLabel value="Engine" for="autocompleteEngine" styleClass="labelNegrito"/></dt>
			    <dd>
	       			<h:inputText id="autocompleteEngine" value="#{xmlBean.campo.autocompleteEngine}"  size="40" maxlength="255" style="text-transform:none;"/>
	       			<rich:message errorClass="error" for="autocompleteEngine" styleClass="message"/>
	       		</dd>
	       		<dt>
			    	<h:outputLabel value="Servico" for="autocompleteService" styleClass="labelNegrito"/>
			    </dt>
			    <dd>
	       			<h:inputText id="autocompleteService" value="#{xmlBean.campo.autocompleteService}"  size="40" maxlength="255" style="text-transform:none;"/>
	       			<rich:message errorClass="error" for="autocompleteService" styleClass="message"/>
	       		</dd>
	       	</a4j:outputPanel>

			<dt><h:outputLabel value="Itens incluídos" for="dataTableItensCampo" rendered="#{not empty xmlBean.campo.itens}" styleClass="labelNegrito"/></dt>
      		
      		<rich:dataTable id="dataTableItensCampo" value="#{xmlBean.campo.itens}" rendered="#{not empty xmlBean.campo.itens}" var="item" rows="20" rowKeyVar="index"
      		   rowClasses="even, odd" 
	      		onRowMouseOver="jQuery(this).addClass('trHover')" 
	      		onRowMouseOut="jQuery(this).removeClass('trHover')" style="width:280px;align:center;">

					<rich:column width="2%" style="text-align: center;" > 
						<f:facet name="header"><h:outputText value="Nº" /></f:facet>
						<h:outputText value="#{index+1}" style="color: black;"/>
					</rich:column>

					<rich:column width="20%" style="text-align: left;" > 
						<f:facet name="header"><h:outputText value="Item" /></f:facet>
						<h:outputText value="#{item}" style="color: black;"/>
					</rich:column>
					<rich:column width="2%" style="text-align: center;">
						<f:facet name="header"><h:outputText value="Excluir" /></f:facet>
						<h:commandLink id="remove" styleClass="excluir"  action="#{xmlBean.removeItemCampo}" value="Excluir">
							<f:setPropertyActionListener target="#{xmlBean.itemToRemove}" value="#{item}"/>
							<a4j:support event="oncomplete" reRender="dataTableItensCampo"/>
						</h:commandLink>
					</rich:column>
					
      		</rich:dataTable>
      		
			<dt><h:outputLabel value="Obrigatório" for="obrigatorio" styleClass="labelNegrito"/></dt>
			<dd>
				<h:selectOneMenu id="obrigatorio" value="#{xmlBean.campo.obrigatorio}" style="width:60px">
					<f:selectItem itemLabel="Sim" itemValue="1"/>
					<f:selectItem itemLabel="Não" itemValue="0"/>
		    		</h:selectOneMenu>
	    		<rich:message errorClass="error" for="obrigatorio" styleClass="message"/>
			</dd>


			<dt><h:outputLabel value="SubNível" for="subnivel" styleClass="labelNegrito"/></dt>
			<dd>
				<h:inputText id="subnivel" value="#{xmlBean.campo.labelSubnivel}"  size="40" maxlength="255" style="text-transform:none;"/>

				<h:selectOneMenu id="subnivelList" value="#{xmlBean.campo.labelSubnivel}" rendered="#{xmlBean.subNiveisStatus and false}" style="width:180px" converter="campoConverter">
					<f:selectItem itemLabel="Selecione ..." itemValue=""/>
    				<t:selectItems value="#{xmlBean.subNivelList}" var="g" itemValue="#{g}" itemLabel="#{g}"/>
    				<a4j:support event="onchange" action="#{xmlBean.populate}"/>
	    		</h:selectOneMenu>
				<rich:message errorClass="error" for="subnivelList" styleClass="message" rendered="false"/>
			</dd>


			<h:commandLink action="#{xmlBean.adicionarCampo}" value="Adicionar" styleClass="novo" style="padding-left:20px">
	      		<a4j:support event="onclick" reRender="dataTable2, subnivelList" />
	      	</h:commandLink>

      	</fieldset>
      	
      	<fieldset>
      		
			<legend>Campos incluídos</legend>		      	
      		<rich:dataTable id="dataTable2" value="#{xmlBean.campos}" var="campo" rows="10" rowKeyVar="index"
      		   rowClasses="even, odd" 
	      		onRowMouseOver="jQuery(this).addClass('trHover')" 
	      		onRowMouseOut="jQuery(this).removeClass('trHover')" width="100%">

 		      	<c:if test="#{empty xmlBean.campos}">
					<rich:column>
						<f:facet name="header">Nenhum campo cadastrado.</f:facet>
					</rich:column>
				</c:if>

	      		<c:if test="#{not empty xmlBean.campos}" >

					<rich:column width="2%" style="text-align: center;" > 
						<f:facet name="header"><h:outputText value="Nº" /></f:facet>
						<h:outputText value="#{index+1}" style="color: black;"/>
					</rich:column>

					<rich:column width="20%" style="text-align: left;" > 
						<f:facet name="header"><h:outputText value="Name" /></f:facet>
						<h:outputText value="#{campo.name}" style="color: black;"/>
					</rich:column>

					<rich:column width="20%" style="text-align: left;" > 
						<f:facet name="header"><h:outputText value="Label" /></f:facet>
						<h:outputText value="#{campo.label}" style="color: black;"/>
					</rich:column>
					
					<rich:column width="20%" style="text-align: left;" > 
						<f:facet name="header"><h:outputText value="Tipo" /></f:facet>
						<h:outputText value="#{campo.tipo}" style="color: black;"/>
					</rich:column>

					<rich:column width="20%" style="text-align: left;" > 
						<f:facet name="header"><h:outputText value="Maskara" /></f:facet>
						<h:outputText value="#{campo.maskara}" style="color: black;"/>
					</rich:column>
					
					<rich:column width="40%" style="text-align: left;" > 
						<f:facet name="header"><h:outputText value="Subnivel" /></f:facet>
						<h:outputText value="#{campo.labelSubnivel}" style="color: black;"/>
					</rich:column>

					<rich:column width="2%" style="text-align: center;">
						<f:facet name="header"><h:outputText value="Excluir" /></f:facet>
						<h:commandLink id="remove" styleClass="excluir"  action="#{xmlBean.removeCampo}" imediate="true" value="Excluir">
							<f:setPropertyActionListener target="#{xmlBean.campo}" value="#{campo}"/>
							<a4j:support event="oncomplete" reRender="paginaPrincipal"/>
						</h:commandLink>
					</rich:column>

				</c:if>
      		</rich:dataTable>
      	
      	
      	</fieldset>


</ui:composition>
